<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Pub Menu - Protected Access</title>
  <style>
    :root{
      --bg:#f7f7f8; --card:#ffffff; --accent:#ef6c4e; --muted:#6b6b6b; --maxw:1000px;
      --radius:14px; --error:#dc2626; --success:#059669;
    }
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:var(--bg); margin:0; color:#111}
    .wrap{max-width:var(--maxw); margin:40px auto; padding:24px}
    h1{font-size:36px; margin-bottom:24px; text-align:center}

    /* Login Form Styles */
    .login-container{
      max-width:400px; margin:60px auto; background:var(--card); 
      border-radius:var(--radius); box-shadow:0 6px 22px rgba(16,24,40,0.12); 
      padding:40px 32px; text-align:center;
    }
    .login-title{font-size:24px; margin-bottom:8px; color:#111}
    .login-subtitle{color:var(--muted); margin-bottom:32px; font-size:14px}
    .pin-input{
      width:100%; padding:14px 16px; border:2px solid #e5e7eb; 
      border-radius:8px; font-size:16px; text-align:center; 
      letter-spacing:4px; margin-bottom:16px; outline:none; transition:border-color 0.2s;
    }
    .pin-input:focus{border-color:var(--accent)}
    .pin-input.error{border-color:var(--error)}
    .login-btn{
      width:100%; padding:14px; background:var(--accent); color:white; 
      border:none; border-radius:8px; font-size:16px; cursor:pointer; 
      transition:background 0.2s;
    }
    .login-btn:hover{background:#d55a3c}
    .login-btn:disabled{background:#ccc; cursor:not-allowed}
    .error-msg{color:var(--error); font-size:14px; margin-top:12px; display:none}

    /* Menu Styles */
    .menu-container{display:none}
    .menu-grid{display:grid; grid-template-columns:1fr; gap:24px}
    @media(min-width:720px){.menu-grid{grid-template-columns:1fr 1fr}}

    .card{background:var(--card); border-radius:var(--radius); box-shadow:0 6px 22px rgba(16,24,40,0.08); overflow:hidden; display:flex; flex-direction:column}

    .media{height:200px; background:#ddd; overflow:hidden}
    .media img{width:100%; height:100%; object-fit:cover; display:block}

    .meta{padding:18px}
    .dish-title{margin:0; font-size:22px}
    .sub{color:var(--muted); margin-bottom:12px; font-size:14px}
    .desc{line-height:1.5; margin-bottom:12px; font-size:15px}
    .ingredients{font-size:14px; color:#333; margin-bottom:12px}
    .ingredients ul{margin:0; padding-left:18px}
    .price{font-weight:700; font-size:16px; color:var(--accent)}

    .logout-btn{
      position:fixed; top:20px; right:20px; padding:8px 16px; 
      background:#666; color:white; border:none; border-radius:6px; 
      cursor:pointer; font-size:14px;
    }
    .logout-btn:hover{background:#555}
  </style>
</head>
<body>
  <!-- Login Form -->
  <div id="loginForm" class="login-container">
    <h2 class="login-title">ðŸ”’ Restricted Access</h2>
    <p class="login-subtitle">Enter PIN to access the menu</p>
    <input type="password" id="pinInput" class="pin-input" placeholder="â€¢â€¢â€¢â€¢" maxlength="4" autocomplete="off">
    <button onclick="checkPin()" class="login-btn" id="loginBtn">Login</button>
    <div id="errorMsg" class="error-msg">Incorrect PIN. Please try again.</div>
    <div style="margin-top:24px; padding-top:24px; border-top:1px solid #e5e7eb; font-size:12px; color:var(--muted)">
      Demo PIN: <strong>1234</strong>
    </div>
  </div>

  <!-- Menu Content (Hidden initially) -->
  <div id="menuContent" class="menu-container">
    <button onclick="logout()" class="logout-btn">Logout</button>
    <main class="wrap">
      <h1>Clapham North Menu</h1>
      <div class="menu-grid" id="menuList"></div>
    </main>
  </div>

  <script>
    // Simple SHA-256 hash for PIN (use crypto library in production)
    async function simpleHash(text) {
      const encoder = new TextEncoder();
      const data = encoder.encode(text);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }

    // Correct PIN hash (hash of "1234")
    const correctPinHash = "f8638b979b2f4f793ddb6dbd197e0ee25a7a6ea32b0ae22f5e3c5d119d839e75";

    // Menu data
    const menu = [
      // STARTERS
      {
        title: "SautÃ©ed Brixham Squid",
        subtitle: "Starter â€¢ 478 kcal",
        description: "Fresh squid with nduja, sourdough, and squid ink aioli.",
        image: "images/squid.jpeg",
        ingredients: ["Brixham squid", "Nduja", "Sourdough", "Squid ink aioli"],
        price: "Â£7.50",
        category: "starters"
      },
      {
        title: "Cauliflower and Vegan Feta Fritters",
        subtitle: "Starter (vg) â€¢ 628 kcal",
        description: "Crispy fritters with Hurfa sweet chilli sauce.",
        image: "",
        ingredients: ["Cauliflower", "Vegan feta", "Hurfa sweet chilli"],
        price: "Â£9.00",
        category: "starters"
      },
      {
        title: "Grilled Tenderstem Broccoli",
        subtitle: "Starter (vg) â€¢ 356 kcal",
        description: "With romesco sauce and smoked almonds.",
        image: "images/broccoli.jpeg",
        ingredients: ["Tenderstem broccoli", "Romesco sauce", "Smoked almonds"],
        price: "Â£7.00",
        category: "starters"
      },
      {
        title: "Fried Buttermilk Chicken Wings",
        subtitle: "Starter â€¢ 679 kcal",
        description: "Crispy wings with hot honey sauce.",
        image: "images/wings.jpeg",
        ingredients: ["Buttermilk chicken wings", "Hot honey sauce"],
        price: "Â£8.00",
        category: "starters"
      },
      {
        title: "Glazed Chicken Skewers",
        subtitle: "Starter â€¢ 370 kcal",
        description: "With miso, lime and tarragon mayo.",
        image: "images/skewers.jpeg",
        ingredients: ["Chicken skewers", "Miso glaze", "Lime", "Tarragon mayo"],
        price: "Â£7.00",
        category: "starters"
      },
      {
        title: "Grilled Corn",
        subtitle: "Starter â€¢ 187 kcal",
        description: "Pico de Gallo with Isle of Wight tomato salsa.",
        image: "images/corn.jpeg",
        ingredients: ["Grilled corn", "Pico de Gallo", "Isle of Wight tomato salsa"],
        price: "Â£4.00",
        category: "starters"
      },
      {
        title: "Naughty Tots",
        subtitle: "Starter â€¢ 771 kcal",
        description: "Pulled chicken thigh, pico de gallo, chicken gravy, melted cheese, crispy shallots, hot honey mayo.",
        image: "images/tots.jpeg",
        ingredients: ["Pulled chicken thigh", "Pico de gallo", "Chicken gravy", "Melted cheese", "Crispy shallots", "Hot honey mayo"],
        price: "Â£8.00",
        category: "starters"
      },
      {
        title: "Triple Cooked Chips",
        subtitle: "Starter â€¢ 673 kcal",
        description: "Our signature crispy chips.",
        image: "images/chips.jpeg",
        ingredients: ["Triple cooked chips"],
        price: "Â£4.50",
        category: "starters"
      },

      // MAINS
      {
        title: "Flat Iron Chicken",
        subtitle: "Main â€¢ 1729 kcal",
        description: "Hassleback jersey royals with pickled fennel salad.",
        image: "images/flatiron.jpeg",
        ingredients: ["Flat iron chicken", "Hassleback jersey royals", "Pickled fennel salad"],
        price: "Â£18.00",
        category: "mains"
      },
      {
        title: "Cyder Battered Haddock & Triple Cooked Chips",
        subtitle: "Main â€¢ 735 kcal",
        description: "Marrowfat peas, curry sauce, tartar sauce, charred lemon.",
        image: "images/fishandchips.jpeg",
        ingredients: ["Cyder battered haddock", "Triple cooked chips", "Marrowfat peas", "Curry sauce", "Tartar sauce", "Charred lemon"],
        price: "Â£19.50",
        category: "mains"
      },
      {
        title: "Buttermilk Chicken Thigh Burger",
        subtitle: "Main â€¢ 1112 kcal",
        description: "Crispy maple cured bacon, honey hot sauce mayo, fennel and lime slaw, fries.",
        image: "images/chickenburger.jpeg",
        ingredients: ["Buttermilk chicken thigh", "Crispy maple cured bacon", "Honey hot sauce mayo", "Fennel and lime slaw", "Fries"],
        price: "Â£16.00",
        category: "mains"
      },
      {
        title: "Clapham North Signature Burger",
        subtitle: "Main â€¢ 946 kcal",
        description: "Burger cheese, pickled onions, gherkin, burger sauce, fries.",
        image: "images/beefburger.jpeg",
        ingredients: ["Beef patty", "Burger cheese", "Pickled onions", "Gherkin", "Burger sauce", "Fries"],
        price: "Â£17.50",
        category: "mains"
      },
      {
        title: "Plant Burger",
        subtitle: "Main (vg) â€¢ 667 kcal",
        description: "Vegan cheddar, pickled onions, gherkin, burger sauce, fries.",
        image: "",
        ingredients: ["Plant-based patty", "Vegan cheddar", "Pickled onions", "Gherkin", "Burger sauce", "Fries"],
        price: "Â£16.50",
        category: "mains"
      },
      {
        title: "Rump Steak",
        subtitle: "Main â€¢ 1230 kcal",
        description: "Bone marrow and wild garlic crumb, Madeira sauce, fries.",
        image: "",
        ingredients: ["Rump steak", "Bone marrow", "Wild garlic crumb", "Madeira sauce", "Fries"],
        price: "Â£19.00",
        category: "mains"
      },

      // PUDDINGS
      {
        title: "Banana Split",
        subtitle: "Pudding (vg) â€¢ 463 kcal",
        description: "Salted caramel ice cream with chocolate chip cookies.",
        image: "",
        ingredients: ["Banana", "Salted caramel ice cream", "Chocolate chip cookies"],
        price: "Â£6.00",
        category: "puddings"
      },
      {
        title: "Honey Roasted Peach",
        subtitle: "Pudding â€¢ 415 kcal",
        description: "Whipped mascarpone with macerated raspberries.",
        image: "",
        ingredients: ["Honey roasted peach", "Whipped mascarpone", "Macerated raspberries"],
        price: "Â£6.00",
        category: "puddings"
      },
      {
        title: "Strawberry & Basil Cheesecake",
        subtitle: "Pudding â€¢ 802 kcal",
        description: "Classic cheesecake with strawberry and basil.",
        image: "",
        ingredients: ["Cheesecake", "Strawberry", "Basil"],
        price: "Â£6.00",
        category: "puddings"
      },
      {
        title: "Ice Cream Scoop",
        subtitle: "Pudding â€¢ 358 kcal",
        description: "Single scoop of premium ice cream.",
        image: "",
        ingredients: ["Premium ice cream"],
        price: "Â£2.50",
        category: "puddings"
      }
    ];

    // Check if user is already authenticated
    function checkAuthStatus() {
      const isAuthenticated = sessionStorage.getItem('authenticated') === 'true';
      if (isAuthenticated) {
        showMenu();
      }
    }

    // PIN verification
    async function checkPin() {
      const pinInput = document.getElementById('pinInput');
      const errorMsg = document.getElementById('errorMsg');
      const loginBtn = document.getElementById('loginBtn');
      
      const enteredPin = pinInput.value.trim();
      
      if (enteredPin.length !== 4) {
        showError('PIN must be 4 digits');
        return;
      }
      
      loginBtn.disabled = true;
      loginBtn.textContent = 'Verifying...';
      
      try {
        const enteredHash = await simpleHash(enteredPin);
        
        if (enteredHash === correctPinHash) {
          // Correct PIN
          sessionStorage.setItem('authenticated', 'true');
          showMenu();
        } else {
          // Incorrect PIN
          showError('Incorrect PIN. Please try again.');
          pinInput.value = '';
          pinInput.focus();
        }
      } catch (error) {
        showError('Verification error. Please try again.');
      }
      
      loginBtn.disabled = false;
      loginBtn.textContent = 'Login';
    }

    // Show error message
    function showError(message) {
      const errorMsg = document.getElementById('errorMsg');
      const pinInput = document.getElementById('pinInput');
      
      errorMsg.textContent = message;
      errorMsg.style.display = 'block';
      pinInput.classList.add('error');
      
      setTimeout(() => {
        errorMsg.style.display = 'none';
        pinInput.classList.remove('error');
      }, 3000);
    }

    // Show menu
    function showMenu() {
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('menuContent').style.display = 'block';
      renderMenu(menu);
    }

    // Logout function
    function logout() {
      sessionStorage.removeItem('authenticated');
      document.getElementById('loginForm').style.display = 'block';
      document.getElementById('menuContent').style.display = 'none';
      document.getElementById('pinInput').value = '';
    }

    // Render menu
    function renderMenu(list) {
      const container = document.getElementById('menuList');
      container.innerHTML = '';
      
      // Group by categories
      const categories = {
        'starters': { title: 'STARTERS', items: [] },
        'mains': { title: 'MAINS', items: [] },
        'puddings': { title: 'PUDDINGS', items: [] }
      };
      
      list.forEach(dish => {
        if (categories[dish.category]) {
          categories[dish.category].items.push(dish);
        }
      });
      
      // Render each category
      Object.values(categories).forEach(category => {
        if (category.items.length > 0) {
          // Category header
          const categoryHeader = document.createElement('div');
          categoryHeader.style.gridColumn = '1 / -1';
          categoryHeader.style.textAlign = 'center';
          categoryHeader.style.margin = '32px 0 24px 0';
          categoryHeader.innerHTML = `<h2 style="font-size: 28px; color: var(--muted); letter-spacing: 2px; margin: 0;">${category.title}</h2>`;
          container.appendChild(categoryHeader);
          
          // Category items
          category.items.forEach(dish => {
            const card = document.createElement('div');
            card.className = 'card';

            card.innerHTML = `
              <div class="media"><img src="${dish.image}" alt="${dish.title}"></div>
              <div class="meta">
                <h3 class="dish-title">${dish.title}</h3>
                <p class="sub">${dish.subtitle}</p>
                <p class="desc">${dish.description}</p>
                <div class="ingredients">
                  <strong>Ingredients:</strong>
                  <ul>${dish.ingredients.map(i=>`<li>${i}</li>`).join('')}</ul>
                </div>
                <div class="price">${dish.price}</div>
              </div>
            `;

            container.appendChild(card);
          });
        }
      });
    }

    // Event listeners
    document.getElementById('pinInput').addEventListener('keypress', function(e) {
      // Accept only numbers
      if (!/[0-9]/.test(e.key) && e.key !== 'Backspace' && e.key !== 'Delete' && e.key !== 'Enter') {
        e.preventDefault();
      }
      
      // Submit on Enter
      if (e.key === 'Enter') {
        checkPin();
      }
    });

    // Check authentication on startup
    checkAuthStatus();
  </script>
</body>
</html>